---
title:   Филтриране на данни
isChild: true
---

## Филтриране на данни

Никога, ама никога, не се доверявайте на външния вход предоставен на вашият PHP код. Винаги филтрирайте и валидирайте 
входа преди да го използвате в кода си. Фунцкиите като `filter_var` и `filter_input` ви помагат да филтрирате и валидирате входа за основните типоер формати (пр.
email адрес, число или др.).

Външния вход може да бъде всичко: `$_GET` или `$_POST` данни от форма, някакви стойности в свръхглобалната променлива `$_SERVER`,
както и тялото на HTTP заявка взето чрез: `fopen('php://input', 'r')`. Запомете външният вход не е ограничен до данни от форма
пуснали от потребителя. Качените и свалени файлове, сесийни стойности, данни в бисквитките и външни данни от уеб услуги на трети страни също.

Когато външни данни са съхранени, комбинирани и достъпени по-късно, те все още са вуншен вход. Всеки път
когато обработвате, извеждате, сбирате и включвате данни в кода си, попотайте се "Данните филтрирани ли са правилно и мога ли да им се доверя?"

Данните могат да се _филтрират_ различно в зависимост от тяхното приложение. Например, когато нефилтрирани входни данни са подадени
на изхода на HTML страница, това може да изпълни HTML и JavaScript във вашият сайт! Тази атака е още известна като Cross-Site
Scripting (XSS) и и не е маловажна, защото може да извлече много данни от потребителите без да знаят. Един начин за предотвратяване на XSS е да се филтрират всички HTML тагове
от входа чрез премахването им или екранитането им.

Друг пример е предаването на опции за изпълнение в команден ред. Това може да е много опастно
(и най-често е много лоша идея), но може да ползвате вдградената фунцкия `escapeshellarg` за
екраниране на аргументите на командата.

Един последен пример e приемането на външен вход за определяне на файл за качване към файловата система. Това може да бъде
експоатирано, като се смени името на файла да бъде файлов път. Товага трбва да премахнете "/" или "../" или [null байтове][6], или др. символи от името/пътя на файла за да не презапише скрити, непублични или други важни файлове.

* [Научи повече за филтрирането на данни][1]
* [Научи повече за `filter_var`][4]
* [Научи повече за `filter_input`][5]
* [Научи повече за работата с null байтове][6]

### Филтриране

Филтрирането на данните премахва (или екранира) невалидните и опасни символи от външния вход. 

Например, вие трябва да филтрирате входа преди включването му в HTML или вкарването му в суров вид в SQL
заявка. Ако ползвате обвързани параметри с [PDO](#databases), то ще филтрира входа вместо вас.

Понякога е нужно да позволите някои безопастни HTML тагове във входа вкогато го включвате в HTML
страница. Това обикновено е много трудоемко и често хората го избягват, като използват по-рестриктивни
формати като Markdown или BBCode, въпреки че съществуват филтриращи библиотеки, като [HTML Purifier][html-purifier]
поради тази причина.

[Прочети повече за филтрите на данни][2]

### Валидация

Валидацията подсигурява външния вход е точно такъв вакъвто очаквате. Например, може да искате да
валидирате email адрес, телефонен номер, дата на раждане като обработвате примерно регистрационна форма.

[Прочети повече за валидаторите на данни][3]

[1]: http://www.php.net/manual/en/book.filter.php
[2]: http://www.php.net/manual/en/filter.filters.sanitize.php
[3]: http://www.php.net/manual/en/filter.filters.validate.php
[4]: http://php.net/manual/en/function.filter-var.php
[5]: http://www.php.net/manual/en/function.filter-input.php
[6]: http://php.net/manual/en/security.filesystem.nullbytes.php
[html-purifier]: http://htmlpurifier.org/
